<!DOCTYPE html>
<html>
<head>
    <title>AI Log Intelligence System</title>

    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
</head>

<body>

<div class="container-fluid main-container">

    <h1 class="text-center dashboard-title">
        AI Log Intelligence & Behavioral Threat Monitor
    </h1>

    <!-- Upload Section -->
    <div class="upload-box">
        <form method="POST" enctype="multipart/form-data" class="row">
            <div class="col-md-9">
                <input type="file" name="logfile" class="form-control" required>
            </div>
            <div class="col-md-3">
                <button class="btn analyze-btn w-100">Analyze Logs</button>
            </div>
        </form>
    </div>

    {% if results %}

    <!-- Stats Cards -->
    <div class="row stats-row">

        <div class="col-md-3">
            <div class="stat-card total-card">
                <h5>Total Logs</h5>
                <h2>{{ results.total_logs }}</h2>
            </div>
        </div>

        <div class="col-md-3">
            <div class="stat-card brute-card">
                <h5>Brute Force Attacks</h5>
                <h2>{{ results.bruteforce|length }}</h2>
            </div>
        </div>

        <div class="col-md-3">
            <div class="stat-card scan-card">
                <h5>Scanning Attempts</h5>
                <h2>{{ results.scanning|length }}</h2>
            </div>
        </div>

        <div class="col-md-3">
            <div class="stat-card anomaly-card">
                <h5>AI Anomalies</h5>
                <h2>{{ results.anomalies|length }}</h2>
            </div>
        </div>

    </div>

    <!-- Chart -->
    <div class="chart-container">
        <canvas id="attackChart"></canvas>
    </div>

    <!-- Detected IP Tables -->
    <div class="row mt-4">

        <div class="col-md-4">
            <div class="table-box">
                <h5>Brute Force IPs</h5>
                <ul>
                    {% for ip in results.bruteforce %}
                        <li>{{ ip }}</li>
                    {% endfor %}
                </ul>
            </div>
        </div>

        <div class="col-md-4">
            <div class="table-box">
                <h5>Scanning IPs</h5>
                <ul>
                    {% for ip in results.scanning %}
                        <li>{{ ip }}</li>
                    {% endfor %}
                </ul>
            </div>
        </div>

        <div class="col-md-4">
            <div class="table-box">
                <h5>AI Flagged IPs</h5>
                <ul>
                    {% for ip in results.anomalies %}
                        <li>{{ ip }}</li>
                    {% endfor %}
                </ul>
            </div>
        </div>

    </div>

    <script>
        new Chart(document.getElementById('attackChart'), {
            type: 'bar',
            data: {
                labels: ['Brute Force', 'Scanning', 'AI Anomalies'],
                datasets: [{
                    label: 'Threat Count',
                    data: [
                        {{ results.bruteforce|length }},
                        {{ results.scanning|length }},
                        {{ results.anomalies|length }}
                    ],
                    backgroundColor: ['#ff3b3b', '#ffc107', '#00e5ff']
                }]
            }
        });
    </script>

    {% endif %}

</div>

</body>
</html>